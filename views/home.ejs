<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        <%= title %>
    </title>
    <link rel="stylesheet" href="/CSS/home.css">
    
</head>

<body>
   

    <div id="heading-container">
        <section id="feed-post">
            <h4>Posts</h4>
            <%if(locals.user){%>
                <form action="/posts/create" id="new-post-form" method="POST">
                    <textarea name="content" id="" cols="30" rows="3" placeholder="Type here.." required></textarea>
                    <input type="submit" value="Post">
                </form>
                <%}%>
                    <div id="posts-list-container">
                        <ul>
                            <% for (let post of posts) { %>
                                <li id="post ">
                                    <p>
                                        <% if (locals.user && locals.user.id==post.user.id){ %>
                                            <small>
                                                <a style="color: black;" href="/posts/destroy/<%= post._id %>">X</a>
                                            </small>
                                            <% } %>
                                                <%= post.content %>
                                                    <small>
                                                        <%= post.user.name %>
                                                    </small>
                                    </p>
                                    <div class="post-comments">
                                        <% if (locals.user){ %>
                                            <form action="/comments/create" method="POST">
                                                <input type="text" name="content" placeholder="Type Here to add comment..."
                                                    required>
                                                <input type="hidden" name="post" value="<%= post._id %>">
                                                <input type="submit" value="Add Comment">
                                            </form>
                                            <% } %>
    
                                                <div class="post-comments-list">
                                                    <ul id="post-comments-<%= post._id %>">
                                                        <% if (post.comments && post.comments.length> 0) { %>
                                                            <% for (let comment of post.comments) { %>
                                                                <li>
                                                                    <p>
                                                                        <%= comment.content %>
                                                                            <% if (locals.user &&
                                                                                locals.user.id==comment.user.id){ %>
                                                                                <small>
                                                                                    <a style="color: black;"
                                                                                        href="/comments/destroy/<%= comment._id %>">Delete</a>
                                                                                </small>
                                                                                <% } %>
    
                                                                                    <br>
                                                                                    <small>
                                                                                        <%= comment.user.name %>
    
                                                                                    </small>
                                                                    </p>
                                                                </li>
                                                                <% } %>
                                                                    <% } else { %>
                                                                        <li>No comments yet.</li>
                                                                        <% } %>
                                                    </ul>
                                                </div>
                                    </div>
                                    
                                </li>
                                <% } %>
                        </ul>
                    </div>
                    
        </section>
        <!-- /******************printing the name of all users on home page*********************/ -->
        <section id="users-friends">
            <h4>Friends</h4>
            <%for(u of all_users ){%>
    
                <p>
                    <a style="color: black;" href="/users/profile/<%= u.id %>">
                        <%= u.name %>
                    </a>
                </p>
                <%}%>
    
        </section>
    
    </div>
    <script src="/js/home_posts.js"></script>
</body>

</html>